{
  "version": "1.0.0",
  "description": "Moteur de règles pour les tables conditionnelles",
  "metadata": {
    "created": "2025-01-05",
    "updated": "2025-01-05",
    "author": "Système d'évaluation clinique",
    "language": "fr-CA"
  },
  "conditional_rules": {
    "C1T22": {
      "table_id": "C1T22",
      "title": "BWAT – Types et quantité de tissus nécrotiques",
      "condition": {
        "type": "field_value",
        "source_table": "C1T21",
        "source_field": "C1T21E01",
        "operator": "gt",
        "threshold": 0,
        "description": "Si tissu nécrotique > 0%"
      },
      "activation": {
        "phase": "immediate",
        "priority": 1,
        "behavior": "auto_activate",
        "notification": {
          "enabled": true,
          "type": "info",
          "message": "Tissu nécrotique détecté : évaluation BWAT des tissus nécrotiques requise",
          "icon": "info"
        }
      },
      "data_binding": {
        "C1T22Q2": {
          "source": "C1T21E01",
          "calculation_type": "percentage_to_score",
          "mapping": {
            "0": { "score": 1, "element": "C1T22E06" },
            "1-24": { "score": 2, "element": "C1T22E07" },
            "25-50": { "score": 3, "element": "C1T22E08" },
            "51-74": { "score": 4, "element": "C1T22E09" },
            "75-100": { "score": 5, "element": "C1T22E10" }
          }
        }
      }
    },
    "C1T34": {
      "table_id": "C1T34",
      "title": "Pied diabétique",
      "condition": {
        "type": "field_contains",
        "source_table": "C1T11",
        "source_field": "C1T11E06",
        "operator": "contains",
        "value": "pied_diabetique",
        "description": "Si pied diabétique est sélectionné dans l'étiologie de la plaie"
      },
      "activation": {
        "phase": "on_next",
        "priority": 2,
        "behavior": "conditional_navigation",
        "notification": {
          "enabled": false,
          "type": "info",
          "message": "Navigation vers l'évaluation du pied diabétique",
          "icon": "info"
        }
      }
    }
  },
  "ui_behavior": {
    "conditional_display": {
      "hidden_by_default": true,
      "show_when_condition_met": true,
      "smooth_transition": true,
      "animation_duration": 300
    },
    "navigation": {
      "skip_conditional_tables": true,
      "show_conditional_indicator": true,
      "conditional_badge": {
        "text": "Conditionnel",
        "color": "#FF9800",
        "icon": "conditional"
      }
    },
    "user_feedback": {
      "show_activation_message": true,
      "show_deactivation_message": false,
      "message_duration": 5000
    }
  },
  "implementation_guide": {
    "step_1": "Vérifier les conditions des tables conditionnelles au chargement",
    "step_2": "Écouter les changements dans les champs sources",
    "step_3": "Activer/désactiver les tables selon les conditions",
    "step_4": "Synchroniser les données calculées en temps réel",
    "step_5": "Mettre à jour l'interface utilisateur",
    "step_6": "Valider les dépendances avant sauvegarde"
  },
  "validation_rules": {
    "conditional_tables": {
      "must_have_condition": true,
      "must_have_source": true,
      "must_have_activation_behavior": true
    },
    "data_binding": {
      "source_field_must_exist": true,
      "calculation_must_be_valid": true,
      "mapping_must_be_complete": true
    }
  }
}
